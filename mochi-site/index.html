<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>mochi | Voice Overlay for Work</title>
	<link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon-32.png" />
	<link rel="apple-touch-icon" href="./assets/mochi-icon.png" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Sora:wght@500;700&display=swap" rel="stylesheet" />
	<style>
		:root {
			--bg: #f3f3ef;
			--panel: #ffffff;
			--text: #111318;
			--muted: #5f636b;
			--border: #d9dde3;
			--accent: #0f1726;
		}

		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		body {
			font-family: "Space Grotesk", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
			color: var(--text);
			background: var(--bg);
			min-height: 100vh;
		}

		main {
			max-width: min(96vw, 1600px);
			margin: 0 auto;
			padding: 20px 14px 24px;
			height: 100vh;
			display: flex;
			flex-direction: column;
		}

		nav {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 14px;
		}

		.brand {
			display: inline-flex;
			align-items: center;
			gap: 10px;
		}

		.brand-icon {
			width: 34px;
			height: 34px;
			border-radius: 9px;
			display: block;
			border: 1px solid var(--border);
			background: #fff;
		}

		.logo {
			font-family: "Sora", sans-serif;
			font-size: 1.08rem;
			letter-spacing: 0.05em;
			text-transform: lowercase;
		}

		.pill {
			display: inline-flex;
			align-items: center;
			padding: 8px 12px;
			border: 1px solid var(--border);
			border-radius: 999px;
			font-size: 0.85rem;
			color: var(--muted);
			text-decoration: none;
			background: var(--panel);
		}

		.hero {
			display: grid;
			grid-template-columns: 40% 60%;
			gap: 14px;
			align-items: stretch;
			flex: 1;
			min-height: 0;
		}

		.copy,
		.video-wrap {
			background: var(--panel);
			border: 1px solid var(--border);
			border-radius: 20px;
		}

		.copy {
			padding: 30px;
			display: flex;
			flex-direction: column;
			gap: 16px;
			justify-content: center;
			min-height: 100%;
		}

		h1 {
			font-family: "Sora", sans-serif;
			font-size: clamp(2.1rem, 5vw, 3.25rem);
			line-height: 1.05;
			letter-spacing: -0.02em;
		}

		.lead {
			font-size: 1.02rem;
			line-height: 1.58;
			color: var(--muted);
			max-width: 54ch;
		}

		.actions {
			display: flex;
			gap: 10px;
			flex-wrap: wrap;
		}

		.btn {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			padding: 11px 14px;
			border-radius: 12px;
			font-weight: 600;
			font-size: 0.95rem;
			text-decoration: none;
			transition: background-color 180ms ease, color 180ms ease, transform 180ms ease;
			border: 1px solid var(--border);
		}

		.btn:hover {
			transform: translateY(-1px);
		}

		.btn.primary {
			background: var(--accent);
			border-color: var(--accent);
			color: #f8fbff;
		}

		.btn.secondary {
			background: #fff;
			color: var(--text);
		}

		.highlights {
			list-style: none;
			display: grid;
			gap: 10px;
			margin-top: 6px;
		}

		.highlights li {
			padding: 10px 12px;
			border-radius: 12px;
			border: 1px solid var(--border);
			background: #fafbfc;
			font-size: 0.92rem;
			color: #20242a;
		}

		.highlights span {
			color: var(--muted);
		}

		.video-wrap {
			position: relative;
			overflow: hidden;
			display: flex;
			align-items: center;
			justify-content: center;
			background: #0b0e15;
			min-height: 0;
			height: 100%;
		}

		.hero-embed {
			width: 100%;
			height: 100%;
			display: block;
			border: 0;
			object-fit: cover;
			object-position: center center;
			background: #05070c;
		}

		.hero-embed.full-visible {
			object-fit: contain;
		}

		.hero-embed.mobile-focus {
			object-fit: cover;
			object-position: 50% 55%;
		}

		@media (max-width: 980px) {
			.hero {
				grid-template-columns: 1fr;
				min-height: auto;
				flex: 0 0 auto;
			}
			.video-wrap {
				min-height: 0;
				height: clamp(300px, 55vh, 520px);
			}
		}

		@media (max-width: 620px) {
			main {
				height: auto;
				min-height: 100vh;
				padding: 20px 14px 30px;
			}
			.copy {
				padding: 20px;
			}
		}
	</style>
</head>
<body>
	<main>
		<nav>
			<div class="brand">
				<img class="brand-icon" src="./assets/mochi-icon.png" alt="mochi icon" />
				<div class="logo">mochi</div>
			</div>
			<a class="pill" href="#">macOS voice overlay</a>
		</nav>

		<section class="hero">
			<div class="copy">
				<h1>Speak naturally. Execute safely.</h1>
				<p class="lead">
					mochi is a native macOS overlay that turns voice into actions across your tools, with local transcription and confirmation before write operations.
				</p>
				<div class="actions">
					<a class="btn primary" href="https://github.com/whiteridge/Mochi" target="_blank" rel="noopener noreferrer">View on GitHub</a>
					<a class="btn secondary" href="https://youtu.be/FS9eAOfU9GE" target="_blank" rel="noopener noreferrer">Watch Demo</a>
				</div>
				<ul class="highlights">
					<li><strong>Local speech-to-text</strong> <span>with Parakeet for low-latency dictation.</span></li>
					<li><strong>Tool routing</strong> <span>for Linear, Slack, GitHub, Notion, Gmail, and Calendar.</span></li>
					<li><strong>Human-in-the-loop</strong> <span>to review and confirm writes before execution.</span></li>
				</ul>
			</div>

			<div class="video-wrap" id="demo">
				<video class="hero-embed" autoplay muted loop playsinline>
					<source src="./assets/hi_res_website_vid_2x.mp4" type="video/mp4" />
				</video>
			</div>
		</section>
	</main>
	<script>
		(() => {
			const video = document.querySelector(".hero-embed");
			const container = document.querySelector(".video-wrap");
			if (!video || !container) return;
			const FALLBACK_DEMO_VIDEO_ID = "FS9eAOfU9GE";
			const FAST_PLAYBACK_RATE = 1;
			const MOBILE_BREAKPOINT = 980;
			const SOURCE_ASPECT_RATIO = 3840 / 2152;
			const MOBILE_MAX_HEIGHT_VH = 0.68;
			const MOBILE_MIN_HEIGHT_PX = 300;
			const FOCUS_VISIBLE_WIDTH = 0.93;
			let usingFallbackEmbed = false;

			const applyPlaybackRate = () => {
				video.defaultPlaybackRate = FAST_PLAYBACK_RATE;
				video.playbackRate = FAST_PLAYBACK_RATE;
			};

			const mountYouTubeFallback = () => {
				if (usingFallbackEmbed) return;
				usingFallbackEmbed = true;

				const iframe = document.createElement("iframe");
				iframe.className = "hero-embed";
				iframe.title = "Mochi demo video";
				iframe.loading = "lazy";
				iframe.allow = "autoplay; encrypted-media; picture-in-picture";
				iframe.referrerPolicy = "strict-origin-when-cross-origin";
				iframe.allowFullscreen = true;
				iframe.src = `https://www.youtube.com/embed/${FALLBACK_DEMO_VIDEO_ID}?autoplay=1&mute=1&loop=1&playlist=${FALLBACK_DEMO_VIDEO_ID}&controls=0&modestbranding=1&rel=0&playsinline=1`;

				container.style.removeProperty("height");
				container.style.removeProperty("min-height");
				video.replaceWith(iframe);
			};

			const updateVideoFit = () => {
				if (usingFallbackEmbed || !video.isConnected) return;
				if (!container.clientWidth) return;
				const videoRatio = video.videoWidth && video.videoHeight
					? video.videoWidth / video.videoHeight
					: SOURCE_ASPECT_RATIO;

				if (window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT}px)`).matches) {
					video.classList.add("mobile-focus");
					video.classList.remove("full-visible");

					const safeRatio = videoRatio * FOCUS_VISIBLE_WIDTH;
					const width = container.clientWidth;
					const maxHeight = window.innerHeight * MOBILE_MAX_HEIGHT_VH;
					// Keep at least FOCUS_VISIBLE_WIDTH of source width visible.
					let nextHeight = width / safeRatio;
					nextHeight = Math.max(MOBILE_MIN_HEIGHT_PX, Math.min(maxHeight, nextHeight));
					container.style.height = `${Math.round(nextHeight)}px`;
					container.style.minHeight = `${Math.round(nextHeight)}px`;
					return;
				}
				video.classList.remove("mobile-focus");
				container.style.removeProperty("height");
				container.style.removeProperty("min-height");

				if (!container.clientHeight) return;
				const containerRatio = container.clientWidth / container.clientHeight;

				if (containerRatio >= videoRatio) {
					video.classList.add("full-visible");
				} else {
					video.classList.remove("full-visible");
				}
			};

			video.addEventListener("loadedmetadata", () => {
				applyPlaybackRate();
				updateVideoFit();
			});
			video.addEventListener("play", applyPlaybackRate);
			video.addEventListener("error", mountYouTubeFallback);
			const source = video.querySelector("source");
			if (source) {
				source.addEventListener("error", mountYouTubeFallback);
			}
			window.addEventListener("resize", updateVideoFit);

			if ("ResizeObserver" in window) {
				const observer = new ResizeObserver(updateVideoFit);
				observer.observe(container);
			}

			applyPlaybackRate();
			updateVideoFit();
		})();
	</script>
</body>
</html>
